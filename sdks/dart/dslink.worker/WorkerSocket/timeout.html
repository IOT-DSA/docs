<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="API docs for the timeout method from the WorkerSocket class, for the Dart programming language.">
  <title>timeout method - WorkerSocket class - dslink.worker library - Dart API</title>
  <!-- required because all the links are pseudo-absolute -->
  <base href="../..">

  <link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Source+Code+Pro|Roboto:500,400italic,300,400' type='text/css'>
  <link rel="stylesheet" href="static-assets/prettify.css">
  <link rel="stylesheet" href="static-assets/css/bootstrap.min.css">
  <link rel="stylesheet" href="static-assets/styles.css">
  <link rel="icon" href="static-assets/favicon.png">

  <!-- Do not remove placeholder -->
  <!-- Header Placeholder -->
</head>

<body>

<div id="overlay-under-drawer"></div>

<header class="container-fluid" id="title">
  <nav class="navbar navbar-fixed-top">
    <div class="container">
      <div class="row">
        <div class="col-sm-12 contents">
          <button id="sidenav-left-toggle" type="button">&nbsp;</button>
          <ol class="breadcrumbs gt-separated hidden-xs">
            <li><a href="index.html">dslink</a></li>
            <li><a href="dslink.worker/dslink.worker-library.html">dslink.worker</a></li>
            <li><a href="dslink.worker/WorkerSocket-class.html">WorkerSocket</a></li>
            <li class="self-crumb">timeout</li>
          </ol>
          <div class="self-name">timeout</div>
          <form class="search navbar-right" role="search">
            <input type="text" id="search-box" autocomplete="off" disabled class="form-control typeahead" placeholder="Loading search...">
          </form>
        </div> <!-- /col -->
      </div> <!-- /row -->
    </div> <!-- /container -->
  </nav>

  <div class="container masthead">
    <div class="row">
      <div class="col-sm-12 contents">
        <ol class="breadcrumbs gt-separated visible-xs">
          <li><a href="index.html">dslink</a></li>
          <li><a href="dslink.worker/dslink.worker-library.html">dslink.worker</a></li>
          <li><a href="dslink.worker/WorkerSocket-class.html">WorkerSocket</a></li>
          <li class="self-crumb">timeout</li>
        </ol>
        <div class="title-description">
          <h1 class="title">
            <span class="kind">method</span> timeout
          </h1>
        </div>
        <ul class="subnav">
          <li><a href="dslink.worker/WorkerSocket/timeout.html#source">Source</a></li>
        </ul>
      </div> <!-- /col -->
    </div> <!-- /row -->
  </div> <!-- /container -->

</header>

<div class="container body">
  <div class="row">

  <div class="col-xs-6 col-sm-3 col-md-2 sidebar sidebar-offcanvas-left">
    <h5><a href="index.html">dslink</a></h5>
    <h5><a href="dslink.worker/dslink.worker-library.html">dslink.worker</a></h5>
    <h5><a href="dslink.worker/WorkerSocket-class.html">WorkerSocket</a></h5>

    <ol>
    
    
    
      <li class="section-title"><a href="dslink.worker/WorkerSocket-class.html#constructors">Constructors</a></li>
      <li><a href="dslink.worker/WorkerSocket/WorkerSocket.master.html">master</a></li>
      <li><a href="dslink.worker/WorkerSocket/WorkerSocket.worker.html">worker</a></li>
    
      <li class="section-title">
        <a href="dslink.worker/WorkerSocket-class.html#instance-properties">Properties</a>
      </li>
      <li><a href="dslink.worker/WorkerSocket/done.html">done</a></li>
      <li class="inherited"><a href="dslink.worker/WorkerSocket/first.html">first</a></li>
      <li class="inherited"><a href="dslink.worker/WorkerSocket/hashCode.html">hashCode</a></li>
      <li class="inherited"><a href="dslink.worker/WorkerSocket/isBroadcast.html">isBroadcast</a></li>
      <li class="inherited"><a href="dslink.worker/WorkerSocket/isEmpty.html">isEmpty</a></li>
      <li><a href="dslink.worker/WorkerSocket/isMaster.html">isMaster</a></li>
      <li><a href="dslink.worker/WorkerSocket/isWorker.html">isWorker</a></li>
      <li class="inherited"><a href="dslink.worker/WorkerSocket/last.html">last</a></li>
      <li class="inherited"><a href="dslink.worker/WorkerSocket/length.html">length</a></li>
      <li><a href="dslink.worker/WorkerSocket/receiver.html">receiver</a></li>
      <li class="inherited"><a href="dslink.worker/WorkerSocket/runtimeType.html">runtimeType</a></li>
      <li><a href="dslink.worker/WorkerSocket/sessions.html">sessions</a></li>
      <li class="inherited"><a href="dslink.worker/WorkerSocket/single.html">single</a></li>
    
      <li class="section-title inherited"><a href="dslink.worker/WorkerSocket-class.html#operators">Operators</a></li>
      <li class="inherited"><a href="dslink.worker/WorkerSocket/operator_equals.html">operator ==</a></li>
    
      <li class="section-title"><a href="dslink.worker/WorkerSocket-class.html#instance-methods">Methods</a></li>
      <li><a href="dslink.worker/WorkerSocket/add.html">add</a></li>
      <li><a href="dslink.worker/WorkerSocket/addError.html">addError</a></li>
      <li><a href="dslink.worker/WorkerSocket/addMethod.html">addMethod</a></li>
      <li><a href="dslink.worker/WorkerSocket/addStream.html">addStream</a></li>
      <li class="inherited"><a href="dslink.worker/WorkerSocket/any.html">any</a></li>
      <li class="inherited"><a href="dslink.worker/WorkerSocket/asBroadcastStream.html">asBroadcastStream</a></li>
      <li class="inherited"><a href="dslink.worker/WorkerSocket/asyncExpand.html">asyncExpand</a></li>
      <li class="inherited"><a href="dslink.worker/WorkerSocket/asyncMap.html">asyncMap</a></li>
      <li><a href="dslink.worker/WorkerSocket/callMethod.html">callMethod</a></li>
      <li><a href="dslink.worker/WorkerSocket/close.html">close</a></li>
      <li class="inherited"><a href="dslink.worker/WorkerSocket/contains.html">contains</a></li>
      <li><a href="dslink.worker/WorkerSocket/createSession.html">createSession</a></li>
      <li class="inherited"><a href="dslink.worker/WorkerSocket/distinct.html">distinct</a></li>
      <li class="inherited"><a href="dslink.worker/WorkerSocket/drain.html">drain</a></li>
      <li class="inherited"><a href="dslink.worker/WorkerSocket/elementAt.html">elementAt</a></li>
      <li class="inherited"><a href="dslink.worker/WorkerSocket/every.html">every</a></li>
      <li class="inherited"><a href="dslink.worker/WorkerSocket/expand.html">expand</a></li>
      <li class="inherited"><a href="dslink.worker/WorkerSocket/firstWhere.html">firstWhere</a></li>
      <li class="inherited"><a href="dslink.worker/WorkerSocket/fold.html">fold</a></li>
      <li class="inherited"><a href="dslink.worker/WorkerSocket/forEach.html">forEach</a></li>
      <li><a href="dslink.worker/WorkerSocket/getMethod.html">getMethod</a></li>
      <li class="inherited"><a href="dslink.worker/WorkerSocket/handleError.html">handleError</a></li>
      <li><a href="dslink.worker/WorkerSocket/init.html">init</a></li>
      <li class="inherited"><a href="dslink.worker/WorkerSocket/join.html">join</a></li>
      <li><a href="dslink.worker/WorkerSocket/kill.html">kill</a></li>
      <li class="inherited"><a href="dslink.worker/WorkerSocket/lastWhere.html">lastWhere</a></li>
      <li><a href="dslink.worker/WorkerSocket/listen.html">listen</a></li>
      <li class="inherited"><a href="dslink.worker/WorkerSocket/map.html">map</a></li>
      <li class="inherited"><a href="dslink.worker/WorkerSocket/noSuchMethod.html">noSuchMethod</a></li>
      <li><a href="dslink.worker/WorkerSocket/ping.html">ping</a></li>
      <li class="inherited"><a href="dslink.worker/WorkerSocket/pipe.html">pipe</a></li>
      <li class="inherited"><a href="dslink.worker/WorkerSocket/reduce.html">reduce</a></li>
      <li><a href="dslink.worker/WorkerSocket/send.html">send</a></li>
      <li class="inherited"><a href="dslink.worker/WorkerSocket/singleWhere.html">singleWhere</a></li>
      <li class="inherited"><a href="dslink.worker/WorkerSocket/skip.html">skip</a></li>
      <li class="inherited"><a href="dslink.worker/WorkerSocket/skipWhile.html">skipWhile</a></li>
      <li><a href="dslink.worker/WorkerSocket/stop.html">stop</a></li>
      <li class="inherited"><a href="dslink.worker/WorkerSocket/take.html">take</a></li>
      <li class="inherited"><a href="dslink.worker/WorkerSocket/takeWhile.html">takeWhile</a></li>
      <li class="inherited"><a href="dslink.worker/WorkerSocket/timeout.html">timeout</a></li>
      <li class="inherited"><a href="dslink.worker/WorkerSocket/toList.html">toList</a></li>
      <li class="inherited"><a href="dslink.worker/WorkerSocket/toSet.html">toSet</a></li>
      <li class="inherited"><a href="dslink.worker/WorkerSocket/toString.html">toString</a></li>
      <li class="inherited"><a href="dslink.worker/WorkerSocket/transform.html">transform</a></li>
      <li><a href="dslink.worker/WorkerSocket/waitFor.html">waitFor</a></li>
      <li class="inherited"><a href="dslink.worker/WorkerSocket/where.html">where</a></li>
    </ol>

  </div><!--/.sidebar-offcanvas-->

  <div class="col-xs-12 col-sm-9 col-md-8 main-content">
    <section class="multi-line-signature">
      <span class="returntype">Stream</span>
      <span class="name ">timeout</span>(<wbr><span class="parameter" id="timeout-param-timeLimit"><span class="type-annotation">Duration</span> <span class="parameter-name">timeLimit</span></span>, {<span class="parameter" id="timeout-param-onTimeout"><span class="type-annotation">void</span> <span class="parameter-name">onTimeout</span>(<span class="parameter" id="onTimeout-param-sink"><span class="type-annotation">EventSink</span> <span class="parameter-name">sink</span></span>)</span>})
    </section>
    <section class="desc markdown">
      <p>Creates a new stream with the same events as this stream.</p>
<p>Whenever more than <code>timeLimit</code> passes between two events from this stream,
the <code>onTimeout</code> function is called.</p>
<p>The countdown doesn't start until the returned stream is listened to.
The countdown is reset every time an event is forwarded from this stream,
or when the stream is paused and resumed.</p>
<p>The <code>onTimeout</code> function is called with one argument: an
<code>EventSink</code> that allows putting events into the returned stream.
This <code>EventSink</code> is only valid during the call to <code>onTimeout</code>.</p>
<p>If <code>onTimeout</code> is omitted, a timeout will just put a <code>TimeoutException</code>
into the error channel of the returned stream.</p>
<p>The returned stream is a broadcast stream if this stream is.
If a broadcast stream is listened to more than once, each subscription
will have its individually timer that starts counting on listen,
and the subscriptions' timers can be paused individually.</p>
    </section>
    
    <section class="summary source-code" id="source">
      <h2><span>Source</span> </h2>
      <pre><code class="prettyprint lang-dart">Stream timeout(Duration timeLimit, {void onTimeout(EventSink sink)}) {
  StreamController controller;
  // The following variables are set on listen.
  StreamSubscription&lt;T&gt; subscription;
  Timer timer;
  Zone zone;
  Function timeout;

  void onData(T event) {
    timer.cancel();
    controller.add(event);
    timer = zone.createTimer(timeLimit, timeout);
  }
  void onError(error, StackTrace stackTrace) {
    timer.cancel();
    assert(controller is _StreamController ||
           controller is _BroadcastStreamController);
    var eventSink = controller;
    eventSink._addError(error, stackTrace);  // Avoid Zone error replacement.
    timer = zone.createTimer(timeLimit, timeout);
  }
  void onDone() {
    timer.cancel();
    controller.close();
  }
  void onListen() {
    // This is the onListen callback for of controller.
    // It runs in the same zone that the subscription was created in.
    // Use that zone for creating timers and running the onTimeout
    // callback.
    zone = Zone.current;
    if (onTimeout == null) {
      timeout = () {
        controller.addError(new TimeoutException(&quot;No stream event&quot;,
                                                 timeLimit), null);
      };
    } else {
      onTimeout = zone.registerUnaryCallback(onTimeout);
      _ControllerEventSinkWrapper wrapper =
          new _ControllerEventSinkWrapper(null);
      timeout = () {
        wrapper._sink = controller;  // Only valid during call.
        zone.runUnaryGuarded(onTimeout, wrapper);
        wrapper._sink = null;
      };
    }

    subscription = this.listen(onData, onError: onError, onDone: onDone);
    timer = zone.createTimer(timeLimit, timeout);
  }
  Future onCancel() {
    timer.cancel();
    Future result = subscription.cancel();
    subscription = null;
    return result;
  }
  controller = isBroadcast
      ? new _SyncBroadcastStreamController(onListen, onCancel)
      : new _SyncStreamController(
            onListen,
            () {
              // Don&apos;t null the timer, onCancel may call cancel again.
              timer.cancel();
              subscription.pause();
            },
            () {
              subscription.resume();
              timer = zone.createTimer(timeLimit, timeout);
            },
            onCancel);
  return controller.stream;
}</code></pre>
    </section>

  </div> <!-- /.main-content -->

</div> <!-- row -->
</div> <!-- container -->

<footer>
  <div class="container-fluid">
    <div class="container">
      <p class="text-center">
        <span class="no-break">
          dslink 1.0.0
        </span>
        &bull;
        <span class="no-break">
          <a href="https://www.dartlang.org">
            <img src="static-assets/favicon.png" alt="Dart" title="Dart" width="16" height="16">
          </a>
        </span>
        &bull;
        <span class="copyright no-break">
          <a href="http://creativecommons.org/licenses/by-sa/4.0/">cc license</a>
        </span>
      </p>
    </div>
  </div>
</footer>

<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
<script src="static-assets/typeahead.bundle.min.js"></script>
<script src="static-assets/prettify.js"></script>
<script src="static-assets/script.js"></script>
<!-- Do not remove placeholder -->
<!-- Footer Placeholder -->

</body>

</html>
